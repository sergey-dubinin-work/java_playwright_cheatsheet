## Playwright trace
Playwright Trace Viewer — это графический инструмент, который помогает вам исследовать записанные трассировки Playwright
после запуска скрипта. Трассировки — отличный способ отладки ваших тестов, когда они не проходят на CI. Это позволяет
выгрузить в архив то, что происходило во время теста.\
### Возможности записанного трейса:
1. Визуальное воспроизведение теста
    - Trace Viewer отображает каждое действие, как в виде таймлайна, так и визуально, с DOM и скриншотами.
    - Можно "перематывать" шаги и видеть, как страница выглядела в момент действия.
   > Как запись экрана, но с доступом к DOM и действиям.
2. Навигация по действиям\
    - Название действия (click, fill, navigate и др.)
    - Целевой элемент (locator)
    - Тайминги (начало, конец, длительность)
    - Результат (успешно или ошибка)
    - Какие события DOM происходили.
    - Что было в инспекторе элемента.
3. Просмотр DOM и состояния страницы
    - Каждый шаг содержит DOM snapshot — можно инспектировать элементы, как в DevTools.
    - Можно посмотреть, был ли элемент видим, доступен, перекрыт и т.п.
4. Анализ сетевых запросов
    - Посмотреть сетевые запросы (вкладка Network).
    - Посмотреть, какие скрипты и стили загружались.
    - Увидеть, какие ответы вернулись от сервера.
5. Поиск и фильтрация действий\
   Можно быстро найти нужный шаг:
    - По действию (click, hover, waitForSelector)
    - По тексту или селектору
6. Просмотр исходных файлов
    - Можно увидеть исходный JS/CSS код, который был загружен.
    - Полезно, чтобы отследить ошибки или неправильную логику фронтенда.

### Польза от использования Playwright trace
- Почему элемент не кликнулся? Был ли он перекрыт?
- Был ли нужный текст в DOM?
- Почему ожидание не сработало?
- Как выглядела страница в момент сбоя?

## Запись трассировки
Трассировки можно записывать с помощью API `BrowserContext.tracing()` следующим образом:

Включение трассировки:
```
BrowserContext context = browser.newContext();

context.tracing().start(               // Включение трассировки
       new Tracing.StartOptions()      // Задание настроек трассировки
               .setScreenshots(true)   // Сохранение скриншотов при каждом действии (click, fill)
               .setSnapshots(true)     // Сохранение состояний DOM дерева до и после каждого действия
               .setSources(true)       // Сохранение загруженных JS и CSS файлов
);

Page page = context.newPage();
```

Завершение и сохранение трассировки
```
context.tracing().stop(new Tracing.StopOptions()
  .setPath(Paths.get("trace.zip")));
```


## Просмотр записанной трассировки:
- Локально с помощью `npx playwright show-trace trace.zip`
- Онлайн на сайте trace.playwright.dev.